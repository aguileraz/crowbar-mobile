<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Crowbar Mobile - Docker Test Dashboard</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    :root {
      --primary: #667eea;
      --secondary: #764ba2;
      --success: #4caf50;
      --warning: #ff9800;
      --danger: #f44336;
      --dark: #1a1a2e;
      --light: #f8f9fa;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
      min-height: 100vh;
      padding: 20px;
    }
    
    .container {
      max-width: 1600px;
      margin: 0 auto;
    }
    
    .header {
      background: white;
      border-radius: 20px;
      padding: 30px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      margin-bottom: 30px;
    }
    
    .header h1 {
      color: var(--dark);
      font-size: 2.5em;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 15px;
    }
    
    .header .subtitle {
      color: #666;
      font-size: 1.1em;
    }
    
    .dashboard-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    
    .metric-card {
      background: white;
      border-radius: 15px;
      padding: 25px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      transition: transform 0.3s ease;
    }
    
    .metric-card:hover {
      transform: translateY(-5px);
    }
    
    .metric-card .label {
      color: #666;
      font-size: 0.9em;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 10px;
    }
    
    .metric-card .value {
      font-size: 2.5em;
      font-weight: bold;
      color: var(--primary);
    }
    
    .metric-card .change {
      font-size: 0.9em;
      margin-top: 5px;
    }
    
    .metric-card .change.positive {
      color: var(--success);
    }
    
    .metric-card .change.negative {
      color: var(--danger);
    }
    
    .test-matrix {
      background: white;
      border-radius: 15px;
      padding: 25px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      margin-bottom: 30px;
    }
    
    .test-matrix h2 {
      color: var(--dark);
      margin-bottom: 20px;
      font-size: 1.8em;
    }
    
    .matrix-table {
      width: 100%;
      border-collapse: collapse;
    }
    
    .matrix-table th,
    .matrix-table td {
      padding: 15px;
      text-align: left;
      border-bottom: 1px solid #e0e0e0;
    }
    
    .matrix-table th {
      background: var(--light);
      font-weight: 600;
      color: var(--dark);
    }
    
    .matrix-table tr:hover {
      background: #f5f5f5;
    }
    
    .status-badge {
      display: inline-block;
      padding: 5px 12px;
      border-radius: 20px;
      font-size: 0.85em;
      font-weight: 600;
      text-transform: uppercase;
    }
    
    .status-badge.success {
      background: var(--success);
      color: white;
    }
    
    .status-badge.failure {
      background: var(--danger);
      color: white;
    }
    
    .status-badge.running {
      background: var(--warning);
      color: white;
    }
    
    .status-badge.pending {
      background: #9e9e9e;
      color: white;
    }
    
    .progress-bar {
      width: 100%;
      height: 8px;
      background: #e0e0e0;
      border-radius: 4px;
      overflow: hidden;
    }
    
    .progress-bar .fill {
      height: 100%;
      background: var(--success);
      transition: width 0.3s ease;
    }
    
    .visual-comparison {
      background: white;
      border-radius: 15px;
      padding: 25px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      margin-bottom: 30px;
    }
    
    .visual-comparison h2 {
      color: var(--dark);
      margin-bottom: 20px;
      font-size: 1.8em;
    }
    
    .screen-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
    }
    
    .screen-card {
      border: 1px solid #e0e0e0;
      border-radius: 10px;
      overflow: hidden;
      transition: transform 0.3s ease;
    }
    
    .screen-card:hover {
      transform: scale(1.05);
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }
    
    .screen-card img {
      width: 100%;
      height: 150px;
      object-fit: cover;
    }
    
    .screen-card .info {
      padding: 10px;
    }
    
    .screen-card .name {
      font-weight: 600;
      color: var(--dark);
      margin-bottom: 5px;
    }
    
    .screen-card .match {
      color: #666;
      font-size: 0.9em;
    }
    
    .timeline {
      background: white;
      border-radius: 15px;
      padding: 25px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
    }
    
    .timeline h2 {
      color: var(--dark);
      margin-bottom: 20px;
      font-size: 1.8em;
    }
    
    .timeline-item {
      display: flex;
      gap: 20px;
      margin-bottom: 20px;
      padding-bottom: 20px;
      border-bottom: 1px solid #e0e0e0;
    }
    
    .timeline-item:last-child {
      border-bottom: none;
    }
    
    .timeline-time {
      flex-shrink: 0;
      width: 80px;
      color: #666;
      font-size: 0.9em;
    }
    
    .timeline-content {
      flex-grow: 1;
    }
    
    .timeline-title {
      font-weight: 600;
      color: var(--dark);
      margin-bottom: 5px;
    }
    
    .timeline-description {
      color: #666;
      font-size: 0.9em;
    }
    
    .refresh-button {
      position: fixed;
      bottom: 30px;
      right: 30px;
      background: var(--primary);
      color: white;
      border: none;
      border-radius: 50%;
      width: 60px;
      height: 60px;
      font-size: 1.5em;
      cursor: pointer;
      box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
      transition: transform 0.3s ease;
    }
    
    .refresh-button:hover {
      transform: scale(1.1);
    }
    
    .refresh-button.spinning {
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    
    .chart-container {
      background: white;
      border-radius: 15px;
      padding: 25px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      margin-bottom: 30px;
    }
    
    .chart-container h2 {
      color: var(--dark);
      margin-bottom: 20px;
      font-size: 1.8em;
    }
    
    #performanceChart {
      max-width: 100%;
      height: 300px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>
        <span>üì±</span>
        Crowbar Mobile - Docker Test Dashboard
      </h1>
      <div class="subtitle">
        Real-time test execution monitoring and results
      </div>
    </div>
    
    <div class="dashboard-grid">
      <div class="metric-card">
        <div class="label">Total Tests</div>
        <div class="value" id="totalTests">0</div>
        <div class="change positive">‚Üë 12% from last run</div>
      </div>
      
      <div class="metric-card">
        <div class="label">Pass Rate</div>
        <div class="value" id="passRate">0%</div>
        <div class="change positive">‚Üë 3% improvement</div>
      </div>
      
      <div class="metric-card">
        <div class="label">Avg Duration</div>
        <div class="value" id="avgDuration">0s</div>
        <div class="change positive">‚Üì 15% faster</div>
      </div>
      
      <div class="metric-card">
        <div class="label">API Coverage</div>
        <div class="value" id="apiCoverage">0/5</div>
        <div class="progress-bar">
          <div class="fill" id="coverageBar" style="width: 0%"></div>
        </div>
      </div>
    </div>
    
    <div class="test-matrix">
      <h2>üß™ Test Execution Matrix</h2>
      <table class="matrix-table">
        <thead>
          <tr>
            <th>API Level</th>
            <th>Android Version</th>
            <th>Device</th>
            <th>Status</th>
            <th>Tests</th>
            <th>Duration</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="testMatrix">
          <!-- Dynamic content -->
        </tbody>
      </table>
    </div>
    
    <div class="visual-comparison">
      <h2>üëÅÔ∏è Visual Regression Results</h2>
      <div class="screen-grid" id="screenGrid">
        <!-- Dynamic content -->
      </div>
    </div>
    
    <div class="chart-container">
      <h2>üìä Performance Trends</h2>
      <canvas id="performanceChart"></canvas>
    </div>
    
    <div class="timeline">
      <h2>üìù Recent Activity</h2>
      <div id="timeline">
        <!-- Dynamic content -->
      </div>
    </div>
    
    <button class="refresh-button" id="refreshButton" onclick="refreshData()">
      üîÑ
    </button>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    // Test data structure
    const testData = {
      totalTests: 145,
      passed: 138,
      failed: 7,
      duration: 245,
      apiLevels: [
        {
          level: 21,
          version: '5.0 (Lollipop)',
          device: 'Nexus 5',
          status: 'success',
          tests: { passed: 45, failed: 2, total: 47 },
          duration: 82
        },
        {
          level: 26,
          version: '8.0 (Oreo)',
          device: 'Pixel 2',
          status: 'success',
          tests: { passed: 46, failed: 1, total: 47 },
          duration: 78
        },
        {
          level: 31,
          version: '12 (S)',
          device: 'Pixel 4',
          status: 'running',
          tests: { passed: 47, failed: 4, total: 51 },
          duration: 85
        }
      ],
      screens: [
        { name: 'Login', match: 96, status: 'pass' },
        { name: 'Profile', match: 93, status: 'pass' },
        { name: 'Shop', match: 95, status: 'pass' },
        { name: 'Product', match: 94, status: 'pass' },
        { name: 'Category', match: 92, status: 'pass' },
        { name: 'Cart', match: 89, status: 'warning' },
        { name: 'Checkout', match: 97, status: 'pass' }
      ],
      timeline: [
        { time: '10:45', title: 'Test Suite Started', description: 'Docker containers initialized' },
        { time: '10:46', title: 'API 21 Tests', description: 'Android 5.0 emulator started' },
        { time: '10:52', title: 'API 26 Tests', description: 'Android 8.0 emulator started' },
        { time: '10:58', title: 'API 31 Tests', description: 'Android 12 emulator started' },
        { time: '11:05', title: 'Visual Regression', description: 'Comparing with prototypes' }
      ]
    };
    
    // Initialize dashboard
    function initDashboard() {
      updateMetrics();
      updateTestMatrix();
      updateScreenGrid();
      updateTimeline();
      initPerformanceChart();
    }
    
    // Update metrics
    function updateMetrics() {
      document.getElementById('totalTests').textContent = testData.totalTests;
      document.getElementById('passRate').textContent = 
        Math.round((testData.passed / testData.totalTests) * 100) + '%';
      document.getElementById('avgDuration').textContent = 
        Math.round(testData.duration / testData.apiLevels.length) + 's';
      
      const coverage = testData.apiLevels.filter(api => 
        api.status === 'success' || api.status === 'running').length;
      document.getElementById('apiCoverage').textContent = 
        coverage + '/' + testData.apiLevels.length;
      document.getElementById('coverageBar').style.width = 
        (coverage / testData.apiLevels.length * 100) + '%';
    }
    
    // Update test matrix
    function updateTestMatrix() {
      const matrix = document.getElementById('testMatrix');
      matrix.innerHTML = testData.apiLevels.map(api => `
        <tr>
          <td><strong>API ${api.level}</strong></td>
          <td>${api.version}</td>
          <td>${api.device}</td>
          <td>
            <span class="status-badge ${api.status}">
              ${api.status}
            </span>
          </td>
          <td>
            ‚úÖ ${api.tests.passed} / ‚ùå ${api.tests.failed}
          </td>
          <td>${api.duration}s</td>
          <td>
            <a href="/results/api-${api.level}/report.html" 
               style="color: var(--primary);">View Report</a>
          </td>
        </tr>
      `).join('');
    }
    
    // Update screen grid
    function updateScreenGrid() {
      const grid = document.getElementById('screenGrid');
      grid.innerHTML = testData.screens.map(screen => `
        <div class="screen-card">
          <img src="/results/screenshots/${screen.name.toLowerCase()}.png" 
               alt="${screen.name}" 
               onerror="this.src='data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"200\" height=\"150\"><rect width=\"200\" height=\"150\" fill=\"%23f0f0f0\"/><text x=\"50%\" y=\"50%\" text-anchor=\"middle\" dy=\".3em\" fill=\"%23999\">${screen.name}</text></svg>'">
          <div class="info">
            <div class="name">${screen.name}</div>
            <div class="match">
              ${screen.match}% match
              ${screen.status === 'pass' ? '‚úÖ' : screen.status === 'warning' ? '‚ö†Ô∏è' : '‚ùå'}
            </div>
          </div>
        </div>
      `).join('');
    }
    
    // Update timeline
    function updateTimeline() {
      const timeline = document.getElementById('timeline');
      timeline.innerHTML = testData.timeline.map(item => `
        <div class="timeline-item">
          <div class="timeline-time">${item.time}</div>
          <div class="timeline-content">
            <div class="timeline-title">${item.title}</div>
            <div class="timeline-description">${item.description}</div>
          </div>
        </div>
      `).join('');
    }
    
    // Initialize performance chart
    function initPerformanceChart() {
      const ctx = document.getElementById('performanceChart').getContext('2d');
      new Chart(ctx, {
        type: 'line',
        data: {
          labels: ['Run 1', 'Run 2', 'Run 3', 'Run 4', 'Run 5', 'Current'],
          datasets: [
            {
              label: 'Test Duration (seconds)',
              data: [280, 265, 250, 248, 246, 245],
              borderColor: '#667eea',
              backgroundColor: 'rgba(102, 126, 234, 0.1)',
              tension: 0.4
            },
            {
              label: 'Pass Rate (%)',
              data: [89, 91, 92, 94, 94, 95],
              borderColor: '#4caf50',
              backgroundColor: 'rgba(76, 175, 80, 0.1)',
              tension: 0.4,
              yAxisID: 'y1'
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            y: {
              type: 'linear',
              display: true,
              position: 'left',
              title: {
                display: true,
                text: 'Duration (s)'
              }
            },
            y1: {
              type: 'linear',
              display: true,
              position: 'right',
              title: {
                display: true,
                text: 'Pass Rate (%)'
              },
              grid: {
                drawOnChartArea: false
              }
            }
          }
        }
      });
    }
    
    // Refresh data
    function refreshData() {
      const button = document.getElementById('refreshButton');
      button.classList.add('spinning');
      
      // Simulate data refresh
      setTimeout(() => {
        // Update with new data
        testData.timeline.unshift({
          time: new Date().toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' }),
          title: 'Dashboard Refreshed',
          description: 'Latest test results loaded'
        });
        
        initDashboard();
        button.classList.remove('spinning');
      }, 1000);
    }
    
    // Auto-refresh every 30 seconds
    setInterval(refreshData, 30000);
    
    // Initialize on load
    document.addEventListener('DOMContentLoaded', initDashboard);
  </script>
</body>
</html>